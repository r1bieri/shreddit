
var POSTINGS = {"postings": [
    {"shortName": "241543903",
      "by": "fridge",
      "date": new Date(2014, 4, 15, 21, 32, 0, 0), // "15.05.2014  21:32",
      "rating": 7,
      "linkURL": "http://www.hsr.ch",
      "linkName": "Hochschule Rapperswil",
      "description": "Wenn man in der Google Bildersuche nach \"241543903\" sucht, findet man Menschen, die ihren Kopf in K&uuml;hlschränke stecken."},
    {"shortName": "Versicherte Nase",
      "by": "cyrano",
      "date": new Date(2014, 4, 14, 9, 47, 0, 0), // "14.05.2014  09:47",
      "rating": 3,
      "linkURL": "http://www.hsr.ch",
      "linkName": "Hochschule Rapperswil",
      "description": "Der Winzer und Weintester Ilja Gort hat seine Nase für 5 Millionen Euro versichern lassen. Die Bedingung der Versicherung war allerdings, dass er weder Motorrad fahren noch boxen noch als Feuerschlucker oder Assistent eines Messerwerfers arbeiten darf."},
    {"shortName": "Pizza",
      "by": "volcano",
      "date": new Date(2014, 5, 30, 15, 22, 0, 0), // "30.04.2014  15:22",
      "rating": 5,
      "linkURL": "http://www.hsr.ch",
      "linkName": "Hochschule Rapperswil",
      "description": "Eine Pizza mit dem Radius z und der Dicke a hat das Volumen Pi • z • z • a."},
    {"shortName": "saippuakivikauppias",
      "by": "cyrano",
      "date": new Date(2011, 5, 22, 23, 59, 0, 0), // "22.04.2011  23:59",
      "rating": 9,
      "linkURL": "http://www.hsr.ch",
      "linkName": "Hochschule Rapperswil",
      "description": "In der finnischen Sprache gibt es das mit 19 Buchstaben weltweit l&auml;ngste Wort, das sich vorw&auml;rts und r&uuml;ckw&auml;rts lesen l&auml;sst: &raquo;saippuakivikauppias&laquo; - &uuml;bersetzt etwa &raquo;Seifenstein-Verk&auml;ufer&laquo;."},
    {"shortName": "Nobelpreis",
      "by": "niels",
      "date": new Date(2011, 6, 22, 11, 32, 0, 0), // "22.05.2011  11:59",
      "rating": 10,
      "linkURL": "http://www.hsr.ch",
      "linkName": "Hochschule Rapperswil",
      "description": "Es war einmal in Kopenhagen.<br>Das nun folgende war wirklich eine Frage, die in einer Physikprüfung, an der Universität von Kopenhagen, gestellt wurde: Beschreiben Sie, wie man die Höhe eines Wolkenkratzers mit einem Barometer feststellt.<br>" +
              "Ein Kursteilnehmer antwortete:<br>Sie binden ein langes Stück Schnur an den Ansatz des Barometers, senken dann das Barometer vom Dach des Wolkenkratzers zum Boden. Die Länge der Schnur plus die Länge des Barometers entspricht der Höhe des Gebäudes. Diese in hohem Grade originelle Antwort entrüstete den Prüfer dermaßen, dass der Kursteilnehmer sofort entlassen wurde. Er appellierte an seine Grundrechte, mit der Begründung dass seine Antwort unbestreitbar korrekt war, und die Universität ernannte einen unabhängigen Schiedsrichter, um den Fall zu entscheiden. Der Schiedsrichter urteilte, dass die Antwort in der Tat korrekt war, aber kein wahrnehmbares Wissen von Physik zeige. Um das Problem zu lösen, wurde entschieden, den Kursteilnehmer nochmals herein zu bitten und ihm sechs Minuten zuzugestehen, in denen er eine mündliche Antwort geben konnte, die mindestens eine minimale Vertrautheit mit den Grundprinzipien von Physik zeigte. Für fünf Minuten saß der Kursteilnehmer still, den Kopf nach vorne, in Gedanken versunken. Der Schiedsrichter erinnerte ihn, dass die Zeit lief, worauf der Kursteilnehmer antwortete, dass er einige extrem relevante Antworten hatte, aber sich nicht entscheiden könnte, welche er verwenden sollte. Als ihm geraten wurde, sich zu beeilen, antwortete er wie folgt: Erstens könnten Sie das Barometer bis zum Dach des Wolkenkratzers nehmen, es über den Rand fallen lassen und die Zeit messen die es braucht, um den Boden zu erreichen. Die Höhe des Gebäudes kann mit der Formel H = 0.5g * t² berechnet werden. Das Barometer wäre allerdings dahin! Oder, falls die Sonne scheint, könnten Sie die Höhe des Barometers messen, es hochstellen und die Länge seines Schattens messen. Dann messen Sie die Länge des Schattens des Wolkenkratzers, anschließend ist es eine einfache Sache, anhand der proportionalen Arithmetik die Höhe des Wolkenkratzers zu berechnen. Wenn Sie aber in einem hohen Grade wissenschaftlich sein wollten, könnten Sie ein kurzes Stück Schnur an das Barometer binden und es schwingen lassen wie ein Pendel, zuerst auf dem Boden und dann auf dem Dach des Wolkenkratzers. Die Höhe entspricht der Abweichung der gravitationalen Wiederherstellungskraft T = 2 Pi im Quadrat (l/g). Oder, wenn der Wolkenkratzer eine äußere Nottreppe besitzt, würde es am einfachsten gehen da hinauf zu steigen, die Höhe des Wolkenkratzers in Barometerlängen abzuhaken und oben zusammenzählen. Wenn Sie aber bloß eine langweilige und orthodoxe Lösung wünschen, dann können Sie selbstverständlich den Barometer benutzen, um den Luftdruck auf dem Dach des Wolkenkratzers und auf dem Grund zu messen und der Unterschied bezüglich der Millibare umzuwandeln, um die Höhe des Gebäudes zu berechnen. Aber, da wir ständig aufgefordert werden die Unabhängigkeit des Verstandes zu üben und wissenschaftliche Methoden anzuwenden, würde es ohne Zweifel viel einfacher sein, an der Tür des Hausmeisters zu klopfen und ihm zu sagen: Wenn Sie einen netten neuen Barometer möchten, gebe ich Ihnen dieses hier, vorausgesetzt Sie sagen mir die Höhe dieses Wolkenkratzers.<br> Der Kursteilnehmer war Niels Bohr, der erste Däne der überhaupt den Nobelpreis für Physik gewann...."
    }
  ]
};

var stars = [
  "&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"rating-stars\">&#xe610;&#xe610;&#xe610;&#xe610;&#xe610;</span>&nbsp;&nbsp;&nbsp;",
  "&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"rating-stars\">&#xe611;&#xe610;&#xe610;&#xe610;&#xe610;</span>&nbsp;&nbsp;&nbsp;",
  "&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"rating-stars\">&#xe612;&#xe610;&#xe610;&#xe610;&#xe610;</span>&nbsp;&nbsp;&nbsp;",
  "&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"rating-stars\">&#xe612;&#xe611;&#xe610;&#xe610;&#xe610;</span>&nbsp;&nbsp;&nbsp;",
  "&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"rating-stars\">&#xe612;&#xe612;&#xe610;&#xe610;&#xe610;</span>&nbsp;&nbsp;&nbsp;",
  "&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"rating-stars\">&#xe612;&#xe612;&#xe611;&#xe610;&#xe610;</span>&nbsp;&nbsp;&nbsp;",
  "&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"rating-stars\">&#xe612;&#xe612;&#xe612;&#xe610;&#xe610;</span>&nbsp;&nbsp;&nbsp;",
  "&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"rating-stars\">&#xe612;&#xe612;&#xe612;&#xe611;&#xe610;</span>&nbsp;&nbsp;&nbsp;",
  "&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"rating-stars\">&#xe612;&#xe612;&#xe612;&#xe612;&#xe610;</span>&nbsp;&nbsp;&nbsp;",
  "&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"rating-stars\">&#xe612;&#xe612;&#xe612;&#xe612;&#xe611;</span>&nbsp;&nbsp;&nbsp;",
  "&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"rating-stars\">&#xe612;&#xe612;&#xe612;&#xe612;&#xe612;</span>&nbsp;&nbsp;&nbsp;"
];

function createCompareFunction(prop, asc) {
  return function(a, b) {
    if (a[prop] > b[prop]) {
      return asc;
    }
    if (a[prop] < b[prop]) {
      return -asc;
    }
    return 0;
  };
}

function sortTopRated() {
  var array = POSTINGS.postings;
  array.sort(createCompareFunction("rating", -1));
}
function sortLeastRated() {
  var array = POSTINGS.postings;
  array.sort(createCompareFunction("rating", 1));
}
function sortAlphabet() {
  var array = POSTINGS.postings;
  array.sort(createCompareFunction("sortName", 1));
}
function sortNewest() {
  var array = POSTINGS.postings;
  array.sort(createCompareFunction("date", -1));
}
function sortOldest() {
  var array = POSTINGS.postings;
  array.sort(createCompareFunction("date", 1));
}



/*
 * Fills the table with the postings.
 *
 * @param {type} table the table-control which is filled with the items.
 *
 * @returns {undefined}
 */
function fillTablePostings(table) {
  var html = [];
  var input = POSTINGS.postings;

  for (var index = 0; index < input.length; index++) {
    var item = input[index];
    html.push("<tr><td class=\"posting-title\">",
            item.shortName,
            "</td><td class=\"posting-rating\">",
            item.by,
            stars[item.rating],
            item.dateString,
            "</td></tr><tr><td colspan=\"2\" class=\"posting-descr\">",
            item.description,
            "<span id=\"plink-" + index + "\" data-url=\"" + item.linkURL + "\" data-name=\"" + item.linkName + "\"></span></td></tr>\n");
  }
  table.html(html.join(''));
}

function preparePostings() {
  var input = POSTINGS.postings;
  for (var index = 0; index < input.length; index++) {
    var item = input[index];
    item.sortName = item.shortName.toLowerCase();
    item.dateString = formatDate(item.date);
  }
}

function formatDate(day) {
  var y = day.getFullYear();
  var m = day.getMonth() + 1;
  var d = day.getDate();
  var h = day.getHours();
  var s = day.getMinutes();
  return '' + (d < 10 ? '0' + d : d) + '.' + (m < 10 ? '0' + m : m) + '.' + y + '&nbsp;&nbsp;&nbsp;' + (h < 10 ? '0' + h : h) + ':' + (s < 10 ? '0' + s : s);
}

var showLinks = false;

/*
 * Show or hide external links. This is just for practice
 */
function toggleLinks() {
  for (var index = 0; ; index++) {
    var item = document.getElementById("plink-" + index);
    if (!item) {
      break;
    }
    if (showLinks) {
      item.innerHTML = "";
    } else {
      item.innerHTML = "<br><span class=\"icon-font\">&#xe618;</span>&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"" + item.getAttribute("data-url") + "\" target=\"_blank\">" + item.getAttribute("data-name") + "</a>";
    }
  }
  showLinks = !showLinks;
  blur();
}
